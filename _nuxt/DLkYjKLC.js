import{p as N,u as S,a as j,g as B,b as I,m as O}from"./ByXFWHz-.js";import{e as C,R as L,q as a,s as M,S as $,x as q,o as u,c as l,F as H,r as R,A as T,j as _,k as U}from"./DEIj63ze.js";const V=["type","sizes","srcset"],D=["src","sizes","srcset"],G=C({__name:"NuxtPicture",props:N,emits:["load","error"],setup(x,{emit:y}){const s=x,v=L(),n=y,b=!1,o=S(),{attrs:z,options:A,modifiers:h}=j(s),d=a(()=>B(s.src)),k=a(()=>["png","webp","gif","svg"].includes(d.value)),i=a(()=>s.legacyFormat?s.legacyFormat:k.value?"png":"jpeg"),p=a(()=>{var g,t;const e=((g=s.format)==null?void 0:g.split(","))||(d.value==="svg"?["svg"]:(t=o.options.format)!=null&&t.length?[...o.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(i.value)&&e.splice(e.indexOf(i.value),1),e.push(i.value),e.map(f=>{const{srcset:E,sizes:P,src:w}=o.getSizes(s.src,{...A.value,sizes:s.sizes||o.options.screens,densities:s.densities,modifiers:{...h.value,format:f}});return{src:w,type:`image/${f}`,sizes:P,srcset:E}}))}),c=a(()=>p.value[p.value.length-1]),m={...s.imgAttrs,"data-nuxt-pic":""};for(const e in v)e in I&&!(e in m)&&(m[e]=v[e]);const r=M(),F=$().isHydrating;return q(()=>{r.value&&(r.value.complete&&F&&(r.value.getAttribute("data-error")?n("error",new Event("error")):n("load",new Event("load"))),r.value.onload=e=>{n("load",e)},r.value.onerror=e=>{n("error",e)},O("nuxt-picture"))}),(e,g)=>(u(),l("picture",null,[(u(!0),l(H,null,R(p.value.slice(0,-1),t=>(u(),l("source",{key:t.src,type:t.type,sizes:t.sizes,srcset:t.srcset},null,8,V))),128)),c.value?(u(),l("img",T({key:0,ref_key:"imgEl",ref:r},{..._(z),..._(b)?{onerror:"this.setAttribute('data-error', 1)"}:{},...m},{src:c.value.src,sizes:c.value.sizes,srcset:c.value.srcset}),null,16,D)):U("",!0)]))}}),W=Object.assign(G,{__name:"NuxtPicture"});export{W as _};
