import{p as N,u as S,a as B,g as I,b as O,m as j}from"./BjlQ4LrZ.js";import{f as C,R as L,k as a,l as M,S as $,p as H,o as u,c as l,F as R,r as T,v as U,g as _,h as V}from"./B4pz-2oQ.js";const q=["type","sizes","srcset"],D=["src","sizes","srcset"],G=C({__name:"NuxtPicture",props:N,emits:["load","error"],setup(x,{emit:y}){const s=x,v=L(),n=y,b=!1,o=S(),{attrs:z,options:h,modifiers:A}=B(s),f=a(()=>I(s.src)),k=a(()=>["png","webp","gif","svg"].includes(f.value)),i=a(()=>s.legacyFormat?s.legacyFormat:k.value?"png":"jpeg"),p=a(()=>{var g,t;const e=((g=s.format)==null?void 0:g.split(","))||(f.value==="svg"?["svg"]:(t=o.options.format)!=null&&t.length?[...o.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(i.value)&&e.splice(e.indexOf(i.value),1),e.push(i.value),e.map(d=>{const{srcset:E,sizes:P,src:w}=o.getSizes(s.src,{...h.value,sizes:s.sizes||o.options.screens,densities:s.densities,modifiers:{...A.value,format:d}});return{src:w,type:`image/${d}`,sizes:P,srcset:E}}))}),c=a(()=>p.value[p.value.length-1]),m={...s.imgAttrs,"data-nuxt-pic":""};for(const e in v)e in O&&!(e in m)&&(m[e]=v[e]);const r=M(),F=$().isHydrating;return H(()=>{r.value&&(r.value.complete&&F&&(r.value.getAttribute("data-error")?n("error",new Event("error")):n("load",new Event("load"))),r.value.onload=e=>{n("load",e)},r.value.onerror=e=>{n("error",e)},j("nuxt-picture"))}),(e,g)=>(u(),l("picture",null,[(u(!0),l(R,null,T(p.value.slice(0,-1),t=>(u(),l("source",{key:t.src,type:t.type,sizes:t.sizes,srcset:t.srcset},null,8,q))),128)),c.value?(u(),l("img",U({key:0,ref_key:"imgEl",ref:r},{..._(z),..._(b)?{onerror:"this.setAttribute('data-error', 1)"}:{},...m},{src:c.value.src,sizes:c.value.sizes,srcset:c.value.srcset}),null,16,D)):V("",!0)]))}}),W=Object.assign(G,{__name:"NuxtPicture"});export{W as _};
