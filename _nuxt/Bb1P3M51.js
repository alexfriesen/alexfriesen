import{p as S,u as B,a as I,g as N,b as C,m as L}from"./mhYMzkqj.js";import{f as M,R as O,k as a,l as $,S as j,p as H,o as c,c as l,F as R,r as T,v as U,g as y,h as V}from"./BxRY9zcv.js";const q=["type","sizes","srcset"],D=["src","sizes","srcset"],Q=M({__name:"NuxtPicture",props:S,emits:["load","error"],setup(_,{emit:x}){const s=_,v=O(),o=x,z=!1,n=B(),{attrs:b,options:h,modifiers:A}=I(s),f=a(()=>N(s.src)),k=a(()=>["png","webp","gif","svg"].includes(f.value)),i=a(()=>s.legacyFormat?s.legacyFormat:k.value?"png":"jpeg"),p=a(()=>{var g,t;const e=((g=s.format)==null?void 0:g.split(","))||(f.value==="svg"?["svg"]:(t=n.options.format)!=null&&t.length?[...n.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(i.value)&&e.splice(e.indexOf(i.value),1),e.push(i.value),e.map(d=>{const{srcset:E,sizes:w,src:P}=n.getSizes(s.src,{...h.value,sizes:s.sizes||n.options.screens,densities:s.densities,modifiers:{...A.value,format:d}});return{src:P,type:`image/${d}`,sizes:w,srcset:E}}))}),u=a(()=>p.value[p.value.length-1]),m={...s.imgAttrs,"data-nuxt-pic":""};for(const e in v)e in C&&!(e in m)&&(m[e]=v[e]);const r=$(),F=j().isHydrating;return H(()=>{r.value&&(r.value.complete&&F&&(r.value.getAttribute("data-error")?o("error",new Event("error")):o("load",new Event("load"))),r.value.onload=e=>{o("load",e)},r.value.onerror=e=>{o("error",e)},L("nuxt-picture"))}),(e,g)=>(c(),l("picture",null,[(c(!0),l(R,null,T(p.value.slice(0,-1),t=>(c(),l("source",{key:t.src,type:t.type,sizes:t.sizes,srcset:t.srcset},null,8,q))),128)),u.value?(c(),l("img",U({key:0,ref_key:"imgEl",ref:r},{...y(b),...y(z)?{onerror:"this.setAttribute('data-error', 1)"}:{},...m},{src:u.value.src,sizes:u.value.sizes,srcset:u.value.srcset}),null,16,D)):V("",!0)]))}});export{Q as _};
